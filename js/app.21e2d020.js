(function(){"use strict";var t={296:function(t,e,i){var s=i(6369),a=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},n=[],r=i(9203),o=function(t,e,i,s){var a,n=arguments.length,r=n<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(t,e,i,s);else for(var o=t.length-1;o>=0;o--)(a=t[o])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};let c=class extends r.w3{};c=o([r.wA],c);var h=c,l=h,d=i(1001),p=(0,d.Z)(l,a,n,!1,null,null,null),f=p.exports,u=i(2631),g=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",[e("SearchBar",{attrs:{placeholder:"輸入城市查看天氣預報",className:"mb-4"},on:{searchClick:t.search}}),e("div",{staticClass:"flex justify-around"},[e("Spinner",{directives:[{name:"show",rawName:"v-show",value:t.isLoading,expression:"isLoading"}]}),e("BarChart",{directives:[{name:"show",rawName:"v-show",value:!t.isLoading,expression:"!isLoading"}],attrs:{datas:t.datas,setting:t.chartSetting.bar}}),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.isLoading,expression:"!isLoading"}],staticClass:"flex flex-wrap w-2/4"},t._l(t.pieChartData.res,(function(i,s){return e("PieChart",{key:s,attrs:{datas:i,title:t.pieChartData.title[s],setting:t.chartSetting.pie}})})),1)],1)],1)},v=[],x=i(2482),w=(i(7658),function(){var t=this,e=t._self._c;t._self._setupProxy;return e("InputGroup",{attrs:{className:t.className},scopedSlots:t._u([{key:"input-group-append",fn:function(){return[e("button",{staticClass:"btn group_append",on:{click:t.searchClick}},[e("font-awesome-icon",{staticClass:"text-white",attrs:{icon:"magnifying-glass"}})],1)]},proxy:!0}])},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.keyword,expression:"keyword"}],staticClass:"group_prepend group_input",class:{"group_input-block":t.isBlock,error:t.inputError},attrs:{placeholder:t.placeholder,type:"text"},domProps:{value:t.keyword},on:{input:function(e){e.target.composing||(t.keyword=e.target.value)}}})])}),y=[],m=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"group",class:t.className},[t._t("input-group-prepend"),t._t("default"),t._t("input-group-append")],2)},S=[],b=function(t,e,i,s){var a,n=arguments.length,r=n<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(t,e,i,s);else for(var o=t.length-1;o>=0;o--)(a=t[o])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};let _=class extends r.w3{constructor(...t){super(...t),(0,x.Z)(this,"className",void 0)}};b([(0,r.fI)({default:""})],_.prototype,"className",void 0),_=b([r.wA],_);var Z=_,O=Z,P=(0,d.Z)(O,m,S,!1,null,null,null),C=P.exports,k=function(t,e,i,s){var a,n=arguments.length,r=n<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(t,e,i,s);else for(var o=t.length-1;o>=0;o--)(a=t[o])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};let j=class extends r.w3{constructor(...t){super(...t),(0,x.Z)(this,"className",void 0),(0,x.Z)(this,"placeholder",void 0),(0,x.Z)(this,"isBlock",void 0),(0,x.Z)(this,"keyword",""),(0,x.Z)(this,"inputError",!1)}searchClick(){this.keyword&&!/[0-9]+/g.test(this.keyword)?(this.inputError=!1,this.$emit("searchClick",this.keyword)):this.inputError=!0}};k([(0,r.fI)({default:""})],j.prototype,"className",void 0),k([(0,r.fI)({default:""})],j.prototype,"placeholder",void 0),k([(0,r.fI)({default:!0})],j.prototype,"isBlock",void 0),j=k([(0,r.wA)({components:{InputGroup:C}})],j);var L=j,R=L,N=(0,d.Z)(R,w,y,!1,null,null,null),A=N.exports,$=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"w-2/4"},[e("canvas",{ref:"canvas",attrs:{id:"chart"}})])},B=[],D=function(t,e,i,s){var a,n=arguments.length,r=n<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(t,e,i,s);else for(var o=t.length-1;o>=0;o--)(a=t[o])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};let I=class extends r.w3{constructor(...t){super(...t),(0,x.Z)(this,"datas",void 0),(0,x.Z)(this,"setting",void 0),(0,x.Z)(this,"canvasSetting",{width:700,height:700,padding:20,gridScale:5}),(0,x.Z)(this,"$refs",void 0),(0,x.Z)(this,"ctx",void 0),(0,x.Z)(this,"maxValue",0)}created(){this.canvasSetting=JSON.parse(JSON.stringify(this.setting)),this.maxValue=this.getMax(this.datas.map((t=>t.main.temp_max)))}mounted(){this.$refs.canvas.width=this.canvasSetting.width,this.$refs.canvas.height=this.canvasSetting.height,this.ctx=this.$refs.canvas.getContext("2d")}drawLine(t,e,i,s,a,n){t.save(),t.strokeStyle=n,t.beginPath(),t.moveTo(e,i),t.lineTo(s,a),t.stroke(),t.restore()}drawBar(t,e,i,s,a,n){t.save(),t.fillStyle=n,t.fillRect(e,i,s,a),t.restore()}drawGridLines(){const t=this.canvasSetting.height-2*this.canvasSetting.padding;let e=0;while(e<=this.maxValue){const i=t*(1-e/this.maxValue)+this.canvasSetting.padding;this.drawLine(this.ctx,0,i,this.canvasSetting.width,i,"#cccccc"),this.drawLine(this.ctx,15,this.canvasSetting.padding/2,15,i+this.canvasSetting.padding/2,"#cccccc"),this.ctx.save(),this.ctx.fillStyle="#333333",this.ctx.textBaseline="bottom",this.ctx.font="bold 12px Arial",this.ctx.fillText(`${e.toString()}℃`,0,i-2),this.ctx.restore(),e+=this.canvasSetting.gridScale}}drawBars(){let t=[...new Set(this.datas.map((t=>t.dt_txt.slice(0,10))))];t=t.slice(1,5);const e=this.canvasSetting.height-2*this.canvasSetting.padding,i=this.canvasSetting.width-2*this.canvasSetting.padding,s=t.length,a=i/s/4;for(let n=0;n<t.length;n++){const i=this.datas.filter((e=>e.dt_txt.startsWith(t[n]))),s=Math.max(...i.map((t=>t.main.temp_max))),r=Math.min(...i.map((t=>t.main.temp_min))),o=Math.round(e*s/this.maxValue),c=Math.round(e*r/this.maxValue);this.drawBar(this.ctx,this.canvasSetting.padding+n*a*4+a,this.canvasSetting.height-o-this.canvasSetting.padding,a,o,"#F92472"),this.drawBar(this.ctx,this.canvasSetting.padding+n*a*4+2*a,this.canvasSetting.height-c-this.canvasSetting.padding,a,c,"#08A6BB"),this.drwaLable(t[n],this.canvasSetting.padding+n*a*4+1.5*a)}}drwaLable(t,e){this.ctx.save(),this.ctx.fillStyle="#333333",this.ctx.textBaseline="bottom",this.ctx.font="bold 12px Arial",this.ctx.fillText(t,e,this.canvasSetting.height),this.ctx.restore()}clearCanvas(){this.ctx.clearRect(0,0,this.canvasSetting.width,this.canvasSetting.height)}draw(){this.clearCanvas(),this.drawGridLines(),this.drawBars()}getMax(t){return Math.max(...t)}datasWatch(t){this.maxValue=this.getMax(t.map((t=>t.main.temp_max))),this.draw()}};D([(0,r.fI)()],I.prototype,"datas",void 0),D([(0,r.fI)({default:()=>({width:700,height:700,padding:20,gridScale:5})})],I.prototype,"setting",void 0),D([(0,r.RL)("datas")],I.prototype,"datasWatch",null),I=D([r.wA],I);var M=I,T=M,E=(0,d.Z)(T,$,B,!1,null,null,null),V=E.exports,W=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"w-2/4"},[e("canvas",{ref:"canvas",attrs:{id:"chart"}})])},F=[],J=function(t,e,i,s){var a,n=arguments.length,r=n<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(t,e,i,s);else for(var o=t.length-1;o>=0;o--)(a=t[o])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};let G=class extends r.w3{constructor(...t){super(...t),(0,x.Z)(this,"datas",void 0),(0,x.Z)(this,"setting",void 0),(0,x.Z)(this,"colorOption",void 0),(0,x.Z)(this,"title",void 0),(0,x.Z)(this,"needLabel",void 0),(0,x.Z)(this,"canvasSetting",{width:700,height:700,padding:20}),(0,x.Z)(this,"chartSetting",{x:350,y:350,r:290}),(0,x.Z)(this,"$refs",void 0),(0,x.Z)(this,"ctx",void 0),(0,x.Z)(this,"beginDeg",0),(0,x.Z)(this,"color",["#F92472","#FAA23D","#B2E64C","#08A6BB","#3590F3","#054A91","#AA7DFC","#4b0082"]),(0,x.Z)(this,"total",0)}created(){this.setting&&(this.canvasSetting=JSON.parse(JSON.stringify(this.setting)),this.chartSetting.x=this.setting.width/2,this.chartSetting.y=this.setting.height/2,this.chartSetting.r=Math.min(this.setting.width,this.setting.height)/2.5-2*this.setting.padding),this.colorOption&&(this.color=JSON.parse(JSON.stringify(this.colorOption)))}mounted(){this.$refs.canvas.width=this.canvasSetting.width,this.$refs.canvas.height=this.canvasSetting.height,this.ctx=this.$refs.canvas.getContext("2d"),this.draw()}drawPie(){this.total=this.datas.reduce(((t,e)=>t+e.value),0);for(let t=0;t<this.datas.length;t++){const e=this.datas[t].value/this.total*360*Math.PI/180,i=this.beginDeg+e;this.ctx.beginPath(),this.ctx.moveTo(this.chartSetting.x,this.chartSetting.y),this.ctx.arc(this.chartSetting.x,this.chartSetting.y,this.chartSetting.r,this.beginDeg,i),this.ctx.fillStyle=this.color[t],this.ctx.fill();const s=this.beginDeg+.5*e,a=this.chartSetting.x+this.chartSetting.r/1.5*Math.cos(s),n=this.chartSetting.y+this.chartSetting.r/1.5*Math.sin(s);this.ctx.font="12px Arial",this.ctx.fillStyle="#ffffff",this.ctx.fillText(this.datas[t].value/this.total*100+"%",a,n),this.beginDeg=i,this.ctx.restore()}}putTitle(){this.ctx.font="12px Arial",this.ctx.fillStyle="#333333",this.ctx.textAlign="start",this.ctx.fillText(`${this.title}濕度`,this.canvasSetting.padding,this.canvasSetting.padding+12)}drawLabel(){for(let t=0;t<this.datas.length;t++)this.ctx.beginPath(),this.ctx.fillStyle=this.color[t],this.ctx.fillRect(this.canvasSetting.padding,this.canvasSetting.height-2*this.canvasSetting.padding-14*t,10,10),this.ctx.font="12px Arial",this.ctx.fillStyle="#333333",this.ctx.textAlign="start",this.ctx.fillText(`濕${this.datas[t].key}%`,2*this.canvasSetting.padding+4,this.canvasSetting.height-10-14*t)}draw(){this.clearCanvas(),this.drawPie(),this.putTitle(),this.needLabel&&this.drawLabel()}clearCanvas(){this.ctx.clearRect(0,0,this.canvasSetting.width,this.canvasSetting.height)}datasWatch(){this.draw()}};J([(0,r.fI)()],G.prototype,"datas",void 0),J([(0,r.fI)()],G.prototype,"setting",void 0),J([(0,r.fI)()],G.prototype,"colorOption",void 0),J([(0,r.fI)({default:""})],G.prototype,"title",void 0),J([(0,r.fI)({default:!0})],G.prototype,"needLabel",void 0),J([(0,r.RL)("datas",{deep:!0})],G.prototype,"datasWatch",null),G=J([r.wA],G);var z=G,q=z,H=(0,d.Z)(q,W,F,!1,null,null,null),K=H.exports,Q=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"spinner",class:`spinner-${t.size} text-${t.color} ${t.className}`},[e("span",[t._v("Loading...")])])},U=[],X=function(t,e,i,s){var a,n=arguments.length,r=n<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(t,e,i,s);else for(var o=t.length-1;o>=0;o--)(a=t[o])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};let Y=class extends r.w3{constructor(...t){super(...t),(0,x.Z)(this,"size",void 0),(0,x.Z)(this,"color",void 0),(0,x.Z)(this,"className",void 0)}};X([(0,r.fI)({default:"md"})],Y.prototype,"size",void 0),X([(0,r.fI)({default:"primary"})],Y.prototype,"color",void 0),X([(0,r.fI)({default:""})],Y.prototype,"className",void 0),Y=X([(0,r.wA)({components:{}})],Y);var tt=Y,et=tt,it=(0,d.Z)(et,Q,U,!1,null,null,null),st=it.exports,at=function(t,e,i,s){var a,n=arguments.length,r=n<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(t,e,i,s);else for(var o=t.length-1;o>=0;o--)(a=t[o])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};let nt=class extends r.w3{constructor(...t){super(...t),(0,x.Z)(this,"key","fec0e7e281da4c7d714ff7a5f6e37a40"),(0,x.Z)(this,"chartSetting",{bar:{width:700,height:750,padding:20,gridScale:5},pie:{width:370,height:370,padding:10}}),(0,x.Z)(this,"datas",[]),(0,x.Z)(this,"isError",!1),(0,x.Z)(this,"isLoading",!1),(0,x.Z)(this,"pieChartData",{res:[],title:[]})}async search(t){this.isLoading=!0,this.isError=!1;try{this.datas=await this.getWeather(await this.getLatLng(t))}catch{this.isError=!0}finally{this.pieChartData=this.assembleData(),this.isLoading=!1}}assembleData(){let t=[...new Set(this.datas.map((t=>t.dt_txt.slice(0,10))))];t=t.slice(1,5);const e=[];for(let i=0;i<t.length;i++){const s=this.datas.filter((e=>e.dt_txt.startsWith(t[i]))),a=s.map((t=>t.main.humidity.toString())),n={},r=[];a.forEach((t=>{t in n?n[t]++:n[t]=1}));for(let t in n)r.push({key:t,value:n[t]});e.push(r)}return{res:e,title:t}}async getLatLng(t){const e=await fetch(`http://api.openweathermap.org/geo/1.0/direct?q=${t}&limit=1&appid=${this.key}`).then((t=>t.json())),{lat:i,lon:s}=e[0];return{lat:i,lon:s}}async getWeather(t){const e=await fetch(`https://api.openweathermap.org/data/2.5/forecast?units=metric&lat=${t.lat}&lon=${t.lon}&appid=${this.key}`).then((t=>t.json()));return e.list}};nt=at([(0,r.wA)({components:{SearchBar:A,BarChart:V,PieChart:K,Spinner:st}})],nt);var rt=nt,ot=rt,ct=(0,d.Z)(ot,g,v,!1,null,null,null),ht=ct.exports;s.ZP.use(u.ZP);const lt=[{path:"/",name:"home",component:ht}],dt=new u.ZP({mode:"history",base:"/weather-forecast/",routes:lt});var pt=dt,ft=i(3822);s.ZP.use(ft.ZP);var ut=new ft.ZP.Store({state:{},getters:{},mutations:{},actions:{},modules:{}}),gt=i(3494),vt=i(7749),xt=i(8539),wt=i(8429);gt.vI.add(xt.mRB),gt.vI.add(wt.NCV),s.ZP.component("font-awesome-icon",vt.GN),s.ZP.config.productionTip=!1,new s.ZP({router:pt,store:ut,render:t=>t(f)}).$mount("#app")}},e={};function i(s){var a=e[s];if(void 0!==a)return a.exports;var n=e[s]={exports:{}};return t[s](n,n.exports,i),n.exports}i.m=t,function(){var t=[];i.O=function(e,s,a,n){if(!s){var r=1/0;for(l=0;l<t.length;l++){s=t[l][0],a=t[l][1],n=t[l][2];for(var o=!0,c=0;c<s.length;c++)(!1&n||r>=n)&&Object.keys(i.O).every((function(t){return i.O[t](s[c])}))?s.splice(c--,1):(o=!1,n<r&&(r=n));if(o){t.splice(l--,1);var h=a();void 0!==h&&(e=h)}}return e}n=n||0;for(var l=t.length;l>0&&t[l-1][2]>n;l--)t[l]=t[l-1];t[l]=[s,a,n]}}(),function(){i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,{a:e}),e}}(),function(){i.d=function(t,e){for(var s in e)i.o(e,s)&&!i.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={143:0};i.O.j=function(e){return 0===t[e]};var e=function(e,s){var a,n,r=s[0],o=s[1],c=s[2],h=0;if(r.some((function(e){return 0!==t[e]}))){for(a in o)i.o(o,a)&&(i.m[a]=o[a]);if(c)var l=c(i)}for(e&&e(s);h<r.length;h++)n=r[h],i.o(t,n)&&t[n]&&t[n][0](),t[n]=0;return i.O(l)},s=self["webpackChunkweather_forecast"]=self["webpackChunkweather_forecast"]||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))}();var s=i.O(void 0,[998],(function(){return i(296)}));s=i.O(s)})();
//# sourceMappingURL=app.21e2d020.js.map